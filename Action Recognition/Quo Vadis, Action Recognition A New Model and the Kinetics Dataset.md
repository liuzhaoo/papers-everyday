本文在新的数据集Kinetics Human Action Video中重新评估了行为识别的SOTA方法。kinetic有 400 种人类动作类别且每个类别超过400个片段。在这个数据集上对当前的行为识别架构做了分析，并且分析了在此数据集上预训练后在其他小数据集的表现。

文章还介绍了一种新的双流模型: I3D，将很深的图像分类卷积网络扩展到3D

在视频领域，在一个足够大数据的数据集上训练的行为分类网络应用于其他时间检测任务或者数据集时，能否会有相似的性能提升，是一个待解决的问题。

本文复现了一些神经网络结构，在Kinetic上进行训练，然后在HMDB-51和UCF-101上微调。为了充分发挥这种方法的提升，设计了I3D结构，它基于Inception v1，并且在Kinetics数据集上预训练后取得了SOTA性能。目前视频架构中主要的区别是卷积和层操作符是使用2D还是3D；网络输入是普通RGB视频还是光流；以及在2D卷积网络中信息如何在帧间传播：是使用LSTM这样的时间卷积层还是在时间维度上聚合特征 。

**本文复现的4种结构以及新结构：**



<img src="https://raw.githubusercontent.com/liuzhaoo/markdown_pics/master/img/i3d 复现的网络.jpg" style="zoom:33%;" />

### 复现的网络



#### 1. ConvNet+LSTM

#### 2. 3D 卷积网络



缺点是由于加入了时间维度，参数变多，而且不能使用ImageNet预训练的数据，所以有一些工作使用较浅的结构从头训练。但是性能没有达到最好。

本文使用C3D结构，有8个卷积层，5个池化层，在最顶端有2个全连接层，输入是16帧112$\times$112的视频段。不同于原结构，本文在所有卷积层和全连接层之后都使用了batch normalization，且在时间上使用2stride而不是1。这会减少内存占用并允许更大的批处理——这对batch normalization很重要



#### 3. 双流网络

将一帧RGB图像和10个计算好的光流帧输入两个在ImageNet预训练好的卷积网络后进行平均预测来对视频片段建模。光流的输入卷积层的通道是普通帧的两倍（因为光流有两个通道：水平和垂直），测试时在视频中采样多个片段并对预测进行平均

一个扩展版本在最后的卷积层将光流和图像融合，本文的提升是基于Inception-V1 的。网络的输入是相隔10帧采样的5个连续的RGB帧，以及对应的光流。Inception-v1的最后一个平均池化层（(5 $\times$ 7 $\times$ 7   对应时间，x，y）前，时间和运动特征通过了512输出的3 $\times$ 3 $\times$ 3   3D卷积层，接着是3 $\times$ 3 $\times$ 3   3D最大池化层。



### I3D



**将2D卷积扩展到3D**：将2D结构的卷积核和池化核扩展——增加一个时间维度。核原本是正方体，将其变为立方体——N $\times$ N 变成 N $\times$ N  $\times$ N .

**参数的处理——如何使用在ImageNet中预训练的参数：** 理论上来说，可以将一个图像复制多份，制成一个视频，然后在ImageNet上训练3D模型。实际上，可以把2D核的权重在时间维度上重复N次，然后都除以N。

**测试感受野在空间、时间和网络深度上的增长** ：在时间维度上如何对池化操作进行扩展（N的大小）以及如何设置卷积/池化的stride是决定感受野大小的主要因素。事实上所有的图像模型对两个空间维度（水平和垂直）的处理是一样的——池化核和stride是相同的。这<font color='cornflowerblue'>*很自然而且意味着网络中的特征深度同样会受二维距离越来越远的图像位置的影响* </font> .然而，当考虑到时间时对称的感受野不一定是最佳的——这应该取决于帧速率和图像尺寸。如果它（感受野）在时间上比空间增长的快，它可能会合并不同物体的边缘，破坏早期的特征检测。但是如果它增长得太慢，就可能不能很好地捕捉场景动态。在Inception-v1中，第一个卷积层的stride是2，接着是是4个stride 为 2 的最大池化层以及一个7$\times$7的平均池化层，最后是线性分类层。在我们的实验中，输入的视频以每秒25帧的速度处理。我们发现在前两个maxpooling层中不执行时间池化很有帮助（使用 1 $\times$ 3  $\times$ 3，时间步长为1的核），但是在其他最大池化层中使用相同的核和步长（使用 3 $\times$ 3  $\times$ 3，所有步长为2的核）。最后的平均池化使用2 $\times$ 7 $\times$ 7 的核。

<img src="https://raw.githubusercontent.com/liuzhaoo/markdown_pics/master/img/I3d.jpg" style="zoom: 40%;" />



